on init
    copy_per_line /dev/cpuctl/tasks /dev/cpuctl/system/tasks

    # Boot time uclamp - HIGH values to ensure CPU scales up
    write /dev/cpuctl/top-app/cpu.uclamp.min 40.00 
    write /dev/cpuctl/foreground/cpu.uclamp.min 30.00
    write /dev/cpuctl/system/cpu.uclamp.min 25.00 
    write /dev/cpuctl/nnapi-hal/cpu.uclamp_min 51.20
    write /proc/sys/kernel/sched_util_clamp_min_rt_default 0

on property:sys.boot_completed=1
    copy_per_line /dev/cpuctl/tasks /dev/cpuctl/system/tasks
    exec u:r:vendor_qti_init_shell:s0 -- /vendor/bin/init.sapphire_perf.sh

    # FIX: Recents & Notification Lag
    # Raised floors to prevent CPU from dropping frequency during UI transitions
    write /dev/cpuctl/top-app/cpu.uclamp.min 45.00
    write /dev/cpuctl/foreground/cpu.uclamp.min 35.00
    write /dev/cpuctl/system/cpu.uclamp.min 35.00
    
    # Latency sensitivity ensures immediate scheduling on Big cores for UI tasks
    write /dev/cpuctl/top-app/cpu.uclamp.latency_sensitive 1
    write /dev/cpuctl/system/cpu.uclamp.latency_sensitive 1
    
    # NO MAX CAPS - let CPU use full performance
    write /dev/cpuctl/background/cpu.uclamp.max 1024
    write /dev/cpuctl/system-background/cpu.uclamp.max 1024
    write /dev/cpuctl/dex2oat/cpu.uclamp.max 1024
    
    # CPU shares
    write /dev/cpuctl/background/cpu.shares 1024
    write /dev/cpuctl/system-background/cpu.shares 1024
    write /dev/cpuctl/dex2oat/cpu.shares 512
    
    # High shares for all UI-critical groups to prevent starvation during uninstalls
    write /dev/cpuctl/system/cpu.shares 20480 
    write /dev/cpuctl/camera-daemon/cpu.shares 20480 
    write /dev/cpuctl/foreground/cpu.shares 20480 
    write /dev/cpuctl/nnapi-hal/cpu.shares 20480 
    write /dev/cpuctl/rt/cpu.shares 20480 
    write /dev/cpuctl/top-app/cpu.shares 20480